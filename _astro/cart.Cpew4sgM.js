let a=[],g=0;const h=4,O=e=>{let n=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},lc:0,listen(r){return t.lc=n.push(r),()=>{for(let i=g+h;i<a.length;)a[i]===r?a.splice(i,h):i+=h;let s=n.indexOf(r);~s&&(n.splice(s,1),--t.lc||t.off())}},notify(r,s){let i=!a.length;for(let o of n)a.push(o,t.value,r,s);if(i){for(g=0;g<a.length;g+=h)a[g](a[g+1],a[g+2],a[g+3]);a.length=0}},off(){},set(r){let s=t.value;s!==r&&(t.value=r,t.notify(s))},subscribe(r){let s=t.listen(r);return r(t.value),s},value:e};return t},S=5,p=6,T=10;let U=(e,n,t,r)=>(e.events=e.events||{},e.events[t+T]||(e.events[t+T]=r(s=>{e.events[t].reduceRight((i,o)=>(o(i),i),{shared:{},...s})})),e.events[t]=e.events[t]||[],e.events[t].push(n),()=>{let s=e.events[t],i=s.indexOf(n);s.splice(i,1),s.length||(delete e.events[t],e.events[t+T](),delete e.events[t+T])}),m=1e3,w=(e,n)=>U(e,r=>{let s=n(r);s&&e.events[p].push(s)},S,r=>{let s=e.listen;e.listen=(...o)=>(!e.lc&&!e.active&&(e.active=!0,r()),s(...o));let i=e.off;return e.events[p]=[],e.off=()=>{i(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let o of e.events[p])o();e.events[p]=[]}},m)},()=>{e.listen=s,e.off=i}});const C=(e={})=>{let n=O(e);return n.setKey=function(t,r){let s=n.value;typeof r>"u"&&t in n.value?(n.value={...n.value},delete n.value[t],n.notify(s,t)):n.value[t]!==r&&(n.value={...n.value,[t]:r},n.notify(s,t))},n};let N=e=>e,u={},c={addEventListener(){},removeEventListener(){}};function I(){try{return typeof localStorage<"u"}catch{return!1}}I()&&(u=localStorage);let M={addEventListener(e,n,t){window.addEventListener("storage",n),window.addEventListener("pageshow",t)},removeEventListener(e,n,t){window.removeEventListener("storage",n),window.removeEventListener("pageshow",t)}};typeof window<"u"&&(c=M);function _(e,n=void 0,t={}){let r=t.encode||N,s=t.decode||N,i=u[e],o=O(e in u?s(i):n),E=o.set;o.set=d=>{i=r(d),typeof i>"u"?delete u[e]:u[e]=i,E(d)};function L(d){d.key===e?d.newValue===null?E(n):E(s(d.newValue)):u[e]||E(n)}function v(){i!==u[e]&&o.set(e in u?s(u[e]):n)}return w(o,()=>{if(v(),t.listen!==!1)return c.addEventListener(e,L,v),()=>{c.removeEventListener(e,L,v)}}),o}function R(e,n={},t={}){let r=t.encode||N,s=t.decode||N,i=C(),o=i.setKey,E=(l,f)=>{typeof f>"u"?(t.listen!==!1&&c.perKey&&c.removeEventListener(e+l,v,d),delete u[e+l]):(t.listen!==!1&&c.perKey&&!(l in i.value)&&c.addEventListener(e+l,v,d),u[e+l]=r(f))};i.setKey=(l,f)=>{E(l,f),o(l,f)};let L=i.set;i.set=function(l){for(let f in l)E(f,l[f]);for(let f in i.value)f in l||E(f,void 0);L(l)};function v(l){l.key?l.key.startsWith(e)&&(l.newValue===null?o(l.key.slice(e.length),void 0):o(l.key.slice(e.length),s(l.newValue))):L({})}function d(){let l={...n};for(let f in u)f.startsWith(e)&&(l[f.slice(e.length)]=s(u[f]));for(let f in l)i.setKey(f,l[f])}return w(i,()=>{if(d(),t.listen!==!1)return c.addEventListener(e,v,d),()=>{c.removeEventListener(e,v,d);for(let l in i.value)c.removeEventListener(e+l,v,d)}}),i}const k=O(!1),y=R("cart:",{},{encode:JSON.stringify,decode:JSON.parse}),q={name:"",email:"",company:"",notes:""},J=_("rfq-contact",q,{encode:JSON.stringify,decode:JSON.parse}),K=e=>{const n=y.get()[e.id];n?y.setKey(e.id,{...n,quantity:n.quantity+e.quantity}):y.setKey(e.id,e),k.set(!0)},Q=(e,n)=>{const t=y.get()[e];t&&(n<=0?A(e):y.setKey(e,{...t,quantity:n}))},A=e=>{y.setKey(e,void 0)},V=()=>{Object.keys(y.get()).forEach(n=>y.setKey(n,void 0))};export{K as a,O as b,y as c,A as d,V as e,k as i,J as r,Q as u};
