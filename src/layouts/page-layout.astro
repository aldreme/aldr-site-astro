---
import "@/styles/globals.css";
import "@/styles/pages/page.css";

import Footer from '@/components/footer';
import Navbar from '@/components/navbar';
import SeoHead from '@/components/seo/SeoHead.astro';
import { supabase } from "@/lib/supabase";

const { pageTitle, seoDescription, seoImage, seoType, seoJsonLd, seoKeywords } = Astro.props;

const currentLocale = Astro.currentLocale || "en";
const { pathname } = Astro.url;

import { getSiteConfigTranslation } from "@/i18n/utils";

// Fetch site_config for Footer
let contactInfo = {};
try {
  const { data } = await supabase.from('site_config').select('*').eq('key', 'contact_info').single();
  if (data) {
    contactInfo = getSiteConfigTranslation(data, currentLocale);
  }
} catch (e) {
  console.error("Error fetching site config", e);
}
---
<!doctype html>
<html lang={currentLocale}>
<SeoHead 
  title={pageTitle}
  description={seoDescription}
  image={seoImage}
  type={seoType}
  jsonLd={seoJsonLd}
  keywords={seoKeywords}
/>

	<body class="bg-black">
		<Navbar client:load currentLang={currentLocale} currentPath={pathname} />

		<main class="w-full min-h-screen md:min-w-400">
			<slot/>
		</main>
		
		<Footer client:visible contactInfo={contactInfo} currentLang={currentLocale} />
	</body>
</html>

<style>
	html {
		margin: 0;
		width: 100%;
		height: 100%;
	}
</style>
