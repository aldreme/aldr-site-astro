---
import GalleryMasonry from '@/components/gallery/GalleryMasonry';
import PageLayout from '@/layouts/page-layout.astro';
import type { ImageMetadata } from 'astro';

// Fetch images from the directory
const imageFiles = import.meta.glob<{ default: ImageMetadata }>('/src/assets/images/product-gallery/*.{jpeg,jpg,png,gif,webp}');
const images = await Promise.all(
  Object.keys(imageFiles).map(async (path) => {
    const image = await imageFiles[path]();
    const filename = path.split('/').pop()?.split('.')[0] || 'Product Image';
    // Clean up filename for alt text (e.g., s-blob-v1-IMAGE-GYV7Fntnac -> Image GYV7Fntnac)
    const alt = filename
      .replace(/^s-blob-v1-IMAGE--/, '')
      .replace(/^s-blob-v1-IMAGE-/, '')
      .replace(/-/g, ' ')
      .replace(/_/g, ' ')
      .trim();
    
    return {
      src: image.default.src,
      alt: alt || 'Product Image',
      width: image.default.width,
      height: image.default.height,
    };
  })
);
---

<PageLayout pageTitle="Product Gallery">
  <div class="bg-zinc-50 dark:bg-zinc-950 min-h-screen py-24 sm:py-32">
    <div class="container mx-auto px-4">
      <div class="max-w-3xl mb-16 px-4">
        <h1 class="text-4xl font-extrabold tracking-tight text-zinc-900 dark:text-white sm:text-6xl mb-6">
          Product Gallery
        </h1>
        <p class="text-lg leading-8 text-zinc-600 dark:text-zinc-400">
          Explore our collection of high-precision stainless steel equipment and laboratory solutions. Each piece is engineered to meet the highest standards of durability and hygiene.
        </p>
      </div>

      <div class="px-4">
        <GalleryMasonry images={images} client:load />
      </div>
    </div>
  </div>
</PageLayout>
